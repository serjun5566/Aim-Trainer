<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Aim Trainer 3D - Global Lobby</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>
    <div class="ui">
        <div>分數: <span id="score">0</span></div>
        <div>時間: <span id="timer">30</span>s</div>
        <div id="connStatus" style="color: #ffcc00;">狀態: 離線</div>
    </div>
    
    <div id="settingsIcon" onclick="openIngameMenu()">⚙️</div>

    <div id="crosshair"></div>

    <div id="leaderboard">
        <h3>排名 (TOP 10)</h3>
        <ul id="leaderList"></ul>
    </div>

    <canvas id="gameCanvas"></canvas>

    <div id="ingameMenu" class="menu-box" style="display: none; position: absolute; z-index: 150; background: rgba(5, 5, 5, 0.95);">
        <h2 style="color: #00ff88; margin-bottom: 20px;">遊戲設定</h2>
        <div class="input-group">
            <label>即時靈敏度: <span id="ingameSensValue">0.002</span></label>
            <input type="range" id="ingameSensRange" min="0.0005" max="0.01" step="0.0005" value="0.002" style="width: 100%;">
        </div>
        <div style="margin-top: 30px; display: flex; flex-direction: column; gap: 12px;">
            <button onclick="resumeGame()">回到遊戲 (Esc)</button>
            <button onclick="quitToLobby()" style="background: #ff4757;">結束並返回大廳</button>
        </div>
    </div>

    <div id="startMenu" class="menu-box">
        <h1>Aim Trainer 3D</h1>
        <div class="menu-controls">
            <div class="input-group">
                <label>玩家名稱:</label>
                <input type="text" id="playerNameInput" placeholder="輸入名字" maxlength="10">
            </div>
            <div class="input-group">
                <label>房間代碼:</label>
                <input type="text" id="roomCodeInput" placeholder="5位代碼" maxlength="5">
            </div>
            <div style="margin-top: 25px;">
                <button onclick="handleEntry()" style="width: 100%;">進入房間</button>
            </div>
        </div>
    </div>

    <div id="lobbyMenu" class="menu-box" style="display: none;">
        <h2>大廳 - 房間: <span id="displayRoomCode"></span></h2>
        <div id="playerList" class="player-grid"></div>
        <div class="lobby-controls">
            <label>滑鼠靈敏度:</label>
            <input type="range" id="sensRange" min="0.0005" max="0.01" step="0.0005" value="0.002">
            <span id="sensValue">0.002</span>
            <button id="applySensBtn" class="small-btn" onclick="applySensitivity()">套用靈敏度</button>
         <button id="practiceBtn" class="small-btn" onclick="startPractice()">試用</button>
            <br><br>
            <button id="readyBtn" onclick="pressReady()">準備開始</button>
            <button id="backBtn" onclick="leaveLobby()" style="background: #ff4757; margin-top: 10px;">返回選單</button>
        </div>
        <button id="exitPracticeBtn" onclick="stopPractice()" style="display: none; position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 100;">結束試用並返回大廳</button>
    </div>

    <script src="script.js"></script>
</body>
</html>